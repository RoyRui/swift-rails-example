h1. Rails Swift Cloud Storage Usage Demo

A simple rails application demonstrating the access of Swift File Storage from within an instance running on a cloud foundry installation.

h2. Introduction

When using cloud foundry services(mysql, postgresql, swift, ...), user credentials are provided as environment variables to the application instances.
These credentials are stored within VCAP_SERVICES. An application can parse these credentials to access the desired services.
This application demonstrates the usage scenario of accessing a Swift File Storage with the credentials provided by the cf_swift_service.

h2. Code Walkthrough

* SwiftController (app/controllers/swift_controller.rb)
** test_swift: performs the test defined in the SwiftTest class (see below)
** read_environment: prints out the environment variables visible to the application

* Swift::Storage (lib/swift/storage.rb)
** wrapper around the fog gem API
** create/delete directories on a swift instance
** upload/download/delete files from/to a swift instance
** create temporary urls
** set directories to private/public

* Swift::SwiftTest
** performs the actual test (perform_test)
** generates a hash containing test outputs
** the test consists of 2 steps:
*** create public and private test directories (create_private_test_directory, create_public_test_directory)
*** upload one example file to each directory (upload_example_file_1, upload_example_file_2)


h3. Local execution

At first you have to create a tenant with the according rights on your Swift Installation.
To be able to execute the application from outside a cloud foundry installation, you have to specify the VCAP_SERVICES environment variable at startup (exchange the dummies with your credentials):

VCAP_SERVICES='{"swift-1.0":[{"name":"swift-50e83","label":"swift-1.0","plan":"free","credentials":{"name":"name","authentication_uri":"https://auth.example.com:5000/v2.0/","user_name":"user_name","user_id":"user_id","password":"password","tenant_name":"tenant_name","tenant_id":"tenant_id","availability_zone":"nova","authentication_version":"v2"}}]}' rails s

